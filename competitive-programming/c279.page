<div id="pf117" class="pf w2 h6" data-page-no="117"><div class="pc pc117 w2 h6"><img class="bi x0 y0 w1 h1" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3AAAAU1CAIAAADdzbFlAAAACXBIWXMAABYlAAAWJQFJUiTwAAAU8klEQVR42u3ZUQ3CQABEQZZUAQpQgyYkoAMZiCE4WT5AALQlacuMhM3l8nKXtjsAABhrbwIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQDACg0mmOh4vhkBANbocTkZYRZeKAEAmCRtrQAAwGheKAEAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQWkCAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAmzOYAGBRkhhhk9oagc1eXM43AABT+PIGAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAASlCQAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBAPgHgwmWL4kRAGAubY0gKB19AGAkzzS/4MsbAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACfGkywCkmMAAAsNFTaWgEAgNF8eQMAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAAgtIEAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQDgFZR5u94PSRKTAADwjScbRCQHq9bCnAAAAABJRU5ErkJggg=="/><div class="t m0 xac h19 y18c ff9c fsc fc2 sc0 ls39 ws2">15.2<span class="_ _2f"> </span>Segment<span class="_ _2d"> </span>T<span class="_ _0"></span>rees<span class="_ _15"> </span>Revisited<span class="_ _94"> </span>273</div><div class="t m0 x35 h20 y18d ff5c fs4 fc2 sc0 lsd ws2">In<span class="_ _d"> </span>this<span class="_ _6"> </span>case,<span class="_ _6"> </span>the<span class="_ _d"> </span>update<span class="_ _6"> </span>for<span class="_ _d"> </span>a<span class="_ _6"> </span>value<span class="_ _d"> </span>at<span class="_ _d"> </span>position<span class="_ _6"> </span><span class="ff9a ls6">i<span class="_ _c"> </span></span><span class="ls24">in<span class="_ _6"> </span><span class="ff9b ls6">[<span class="ff9a">a<span class="_ _5"></span><span class="ff56">,<span class="_ _15"> </span></span>b</span>]<span class="_ _6"> </span></span>is<span class="_ _3"> </span><span class="ff9a ls6">p<span class="_ _5"></span><span class="ff56">(</span>i<span class="_ _c"> </span><span class="ff9b">−<span class="_ _6"> </span></span>a<span class="_ _5"></span><span class="ff56">)</span></span><span class="lse">.<span class="_ _6"> </span>For<span class="_ _d"> </span>example,</span></span></div><div class="t m0 xac h20 y18e ff5c fs4 fc2 sc0 lsc ws2">adding<span class="_ _3"> </span>the<span class="_ _b"> </span>polynomial<span class="_ _14"> </span><span class="ff9a ls6">p<span class="_ _5"></span><span class="ff56">(</span>u<span class="_ _5"></span><span class="ff56">)<span class="_ _c"> </span><span class="ff9b">=<span class="_ _4"> </span></span></span>u<span class="_"> </span><span class="ff9b">+<span class="_ _6"> </span></span></span><span class="ls199">1t<span class="_ _61"></span>o<span class="ff9b ls6">[<span class="ff9a">a<span class="_ _5"></span><span class="ff56">,<span class="_ _15"> </span></span>b</span>]<span class="_ _b"> </span></span><span class="lsc">means<span class="_ _b"> </span>that<span class="_ _b"> </span>the<span class="_ _3"> </span>value<span class="_ _3"> </span>at<span class="_ _b"> </span>position<span class="_ _b"> </span><span class="ff9a ls6">a</span></span></span></div><div class="t m0 xac h20 y18f ff5c fs4 fc2 sc0 lsc ws2">increases<span class="_ _6"> </span>by<span class="_ _4"> </span>1,<span class="_ _6"> </span>the<span class="_ _4"> </span>value<span class="_ _6"> </span>at<span class="_ _6"> </span>position<span class="_ _4"> </span><span class="ff9a ls6">a<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span></span>1<span class="_ _6"> </span>increases<span class="_ _4"> </span>by<span class="_ _6"> </span>2,<span class="_ _4"> </span>and<span class="_ _4"> </span>so<span class="_ _6"> </span>on.</div><div class="t m0 x35 h20 y190 ff5c fs4 fc2 sc0 lsc ws2">T<span class="_ _16"></span>o<span class="_ _2d"> </span>support<span class="_ _2d"> </span>polynomial<span class="_ _2d"> </span>updates,<span class="_ _15"> </span>each<span class="_ _2d"> </span>node<span class="_ _2d"> </span>is<span class="_ _15"> </span>assigned<span class="_ _2d"> </span><span class="ff9a ls6">k<span class="_ _c"> </span><span class="ff9b">+<span class="_ _6"> </span></span></span><span class="lsd">2<span class="_ _2d"> </span>values,<span class="_ _20"> </span>where<span class="_ _2d"> </span><span class="ff9a ls6">k<span class="_"> </span></span><span class="lse">equals</span></span></div><div class="t m0 xac h15 y191 ff5c fs4 fc2 sc0 lsc ws2">the<span class="_ _c"> </span>de<span class="_ _0"></span>gree<span class="_ _c"> </span>of<span class="_ _c"> </span>the<span class="_ _c"> </span>polynomial.<span class="_ _4"> </span>The<span class="_ _c"> </span>value<span class="_ _4"> </span><span class="ff9a ls6">s<span class="_ _b"> </span></span>is<span class="_ _c"> </span>the<span class="_ _c"> </span>sum<span class="_ _4"> </span>of<span class="_ _c"> </span>the<span class="_ _c"> </span>elements<span class="_ _c"> </span>in<span class="_ _c"> </span>the<span class="_ _4"> </span>range,</div><div class="t m0 xac h15 y192 ff5c fs4 fc2 sc0 lse ws2">and<span class="_ _d"> </span>the<span class="_ _6"> </span>values<span class="_ _6"> </span><span class="ff9a ls6">z</span></div><div class="t m0 x1f h1b y122a ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x16a h2a y794 ff56 fs4 fc2 sc0 ls6 ws2">,<span class="_ _15"> </span><span class="ff9a">z</span></div><div class="t m0 x48 h1b y122a ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x71 h2a y794 ff56 fs4 fc2 sc0 lsb1 ws2">,...,<span class="ff9a ls6">z</span></div><div class="t m0 x1a4 h29 y122a ff9a fs10 fc2 sc0 ls6 ws2">k</div><div class="t m0 x13d h15 y794 ff5c fs4 fc2 sc0 lsc ws2">are<span class="_ _d"> </span>the<span class="_ _6"> </span>coefﬁcients<span class="_ _d"> </span>of<span class="_ _6"> </span>a<span class="_ _6"> </span>polynomial<span class="_ _d"> </span>that<span class="_ _6"> </span>corresponds<span class="_ _6"> </span>to</div><div class="t m0 xac h20 y795 ff5c fs4 fc2 sc0 lse ws2">a<span class="_ _6"> </span>lazy<span class="_ _4"> </span>update.<span class="_ _6"> </span>Now<span class="_ _16"></span>,<span class="_ _4"> </span>the<span class="_ _6"> </span>sum<span class="_ _4"> </span>of<span class="_ _6"> </span>values<span class="_ _6"> </span>in<span class="_ _4"> </span>a<span class="_ _6"> </span>range<span class="_ _4"> </span><span class="ff9b ls6">[<span class="_ _5"></span><span class="ff9a">x<span class="_ _36"></span><span class="ff56">,<span class="_ _6"> </span></span>y<span class="_ _5"></span></span>]<span class="_ _4"> </span></span>equals</div><div class="t m0 x59 h20 y2d64 ff9a fs4 fc2 sc0 ls6 ws2">s<span class="_ _4"> </span><span class="ff9b">+</span></div><div class="t m0 x1c1 h25 y2d65 ff9a fs10 fc2 sc0 ls6 ws2">y<span class="_ _5"></span><span class="ff9b">−<span class="_ _5"></span></span>x</div><div class="t m0 x80 h37 y2d66 ffa0 fs4 fc2 sc0 ls6 ws2"></div><div class="t m0 x80 h25 y2d67 ff9a fs10 fc2 sc0 ls6 ws2">u<span class="_ _5"></span><span class="ff9b">=<span class="ff5c">0</span></span></div><div class="t m0 x75 h2a y2d68 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff9a">z</span></div><div class="t m0 xc4 h29 y2d69 ff9a fs10 fc2 sc0 ls6 ws2">k</div><div class="t m0 x19 h2a y2d68 ff9a fs4 fc2 sc0 ls6 ws2">u</div><div class="t m0 x17 h29 y981 ff9a fs10 fc2 sc0 ls6 ws2">k</div><div class="t m0 x1b4 h20 y2d68 ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _6"> </span><span class="ff9a">z</span></div><div class="t m0 x4f h25 y2d69 ff9a fs10 fc2 sc0 ls6 ws2">k<span class="_ _5"></span><span class="ff9b">−<span class="ff5c">1</span></span></div><div class="t m0 x1a8 h2a y2d68 ff9a fs4 fc2 sc0 ls6 ws2">u</div><div class="t m0 x31 h25 y981 ff9a fs10 fc2 sc0 ls6 ws2">k<span class="_ _5"></span><span class="ff9b">−<span class="ff5c">1</span></span></div><div class="t m0 x65 h20 y2d68 ff9b fs4 fc2 sc0 ls35 ws2">+<span class="_ _5"></span>···<span class="_ _2a"></span>+<span class="_ _36"></span><span class="ff9a ls6">z</span></div><div class="t m0 xf1 h1b y2d69 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x30 h20 y2d68 ff9a fs4 fc2 sc0 ls6 ws2">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>z</div><div class="t m0 xfb h1b y2d69 ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 xbb h2b y2d68 ff56 fs4 fc2 sc0 ls17 ws2">),</div><div class="t m0 xac h15 y2d6a ff5c fs4 fc2 sc0 lsc ws2">and<span class="_ _c"> </span>the<span class="_ _c"> </span>v<span class="_ _0"></span>alue<span class="_ _c"> </span>of<span class="_ _c"> </span>such<span class="_ _c"> </span>a<span class="_ _c"> </span>sum<span class="_ _c"> </span>can<span class="_ _c"> </span>be<span class="_ _c"> </span>ef<span class="_ _0"></span>ﬁciently<span class="_ _c"> </span>calculated<span class="_ _c"> </span>using<span class="_ _c"> </span>sum<span class="_ _c"> </span>formulas.<span class="_ _c"> </span>F<span class="_ _0"></span>or</div><div class="t m0 xac h15 y2d6b ff5c fs4 fc2 sc0 lsc ws2">example,<span class="_ _d"> </span>the<span class="_ _6"> </span>term<span class="_ _4"> </span><span class="ff9a ls6">z</span></div><div class="t m0 xbc h1b y2d6c ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x5 h15 y2d6d ff5c fs4 fc2 sc0 lsc ws2">corresponds<span class="_ _6"> </span>to<span class="_ _6"> </span>the<span class="_ _d"> </span>sum<span class="_ _4"> </span><span class="ff9a ls6">z</span></div><div class="t m0 x86 h1b y2d6c ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x192 h20 y2d6d ff56 fs4 fc2 sc0 ls6 ws2">(<span class="_ _2a"></span><span class="ff9a">y<span class="_ _4"> </span><span class="ff9b">−<span class="_ _4"> </span></span>x<span class="_ _c"> </span><span class="ff9b">+<span class="_ _6"> </span><span class="ff5c">1</span></span></span>)<span class="ff5c lsc">,<span class="_ _d"> </span>and<span class="_ _6"> </span>the<span class="_ _6"> </span>term<span class="_ _4"> </span></span><span class="ff9a">z</span></div><div class="t m0 x15d h1b y2d6c ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x1c3 h15 y2d6d ff9a fs4 fc2 sc0 ls6 ws2">u<span class="_ _4"> </span><span class="ff5c lsd">corre-</span></div><div class="t m0 xac h15 y2d6e ff5c fs4 fc2 sc0 lsc ws2">sponds<span class="_ _6"> </span>to<span class="_ _4"> </span>the<span class="_ _6"> </span>sum</div><div class="t m0 x175 h2a y2d6f ff9a fs4 fc2 sc0 ls6 ws2">z</div><div class="t m0 x2f h1b y2d70 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x1d3 h20 y2d71 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff5c">0<span class="_ _6"> </span><span class="ff9b">+<span class="_ _d"> </span></span>1<span class="_ _6"> </span><span class="ff9b ls35">+<span class="_ _2a"></span>···<span class="_ _2a"></span>+<span class="_ _20"></span></span><span class="ff9a">y<span class="_ _4"> </span><span class="ff9b">−<span class="_ _4"> </span></span>x<span class="_ _36"></span></span></span>)<span class="_ _4"> </span><span class="ff9b">=<span class="_ _c"> </span><span class="ff9a">z</span></span></div><div class="t m0 x109 h1b y2d70 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x42 h20 y2d72 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="_ _2a"></span><span class="ff9a">y<span class="_ _4"> </span><span class="ff9b">−<span class="_ _4"> </span></span>x<span class="_ _36"></span></span><span class="ls17">)(<span class="_ _2a"></span></span><span class="ff9a">y<span class="_"> </span><span class="ff9b">−<span class="_ _4"> </span></span>x<span class="_ _c"> </span><span class="ff9b">+<span class="_ _6"> </span><span class="ff5c">1</span></span></span>)</div><div class="t m0 x185 h15 y2d73 ff5c fs4 fc2 sc0 ls6 ws2">2</div><div class="t m0 x105 h2b y2d74 ff56 fs4 fc2 sc0 ls6 ws2">.</div><div class="t m0 x35 h15 y2d75 ff5c fs4 fc2 sc0 lse ws2">When<span class="_ _c"> </span>propagating<span class="_ _4"> </span>an<span class="_ _c"> </span>update<span class="_ _4"> </span>in<span class="_ _c"> </span>the<span class="_ _c"> </span>tree,<span class="_ _4"> </span>the<span class="_ _c"> </span>indices<span class="_ _4"> </span>of<span class="_ _13"> </span><span class="ff9a ls6">p<span class="_ _5"></span><span class="ff56">(</span>u<span class="_ _2a"></span><span class="ff56">)<span class="_ _c"> </span></span></span>change,<span class="_ _4"> </span>because<span class="_ _c"> </span>in</div><div class="t m0 xac h20 y2d76 ff5c fs4 fc2 sc0 lse ws2">each<span class="_ _c"> </span>range<span class="_ _3"> </span><span class="ff9b ls6">[<span class="_ _5"></span><span class="ff9a">x<span class="_ _2a"></span><span class="ff56">,<span class="_ _6"> </span></span>y<span class="_ _2a"></span></span>]</span><span class="lsc">,<span class="_ _3"> </span>the<span class="_ _c"> </span>values<span class="_ _c"> </span>are<span class="_ _c"> </span>calculated<span class="_ _3"> </span>for<span class="_ _c"> </span><span class="ff9a ls6">u<span class="_ _3"> </span><span class="ff9b">=<span class="_ _c"> </span><span class="ff5c">0<span class="ff56">,<span class="_ _2d"> </span></span>1<span class="ff56 ls46">,...,<span class="_ _2a"></span></span></span></span>y<span class="_ _4"> </span><span class="ff9b">−<span class="_ _4"> </span></span>x<span class="_ _36"></span></span><span class="ls56">.<span class="_ _3"> </span>H<span class="_ _5"></span>ow<span class="_ _5"></span>eve<span class="_ _5"></span>r,<span class="_ _3"> </span>we</span></span></div><div class="t m0 xac h15 y2d77 ff5c fs4 fc2 sc0 lsd ws2">can<span class="_ _d"> </span>easily<span class="_ _6"> </span>handle<span class="_ _6"> </span>this,<span class="_ _d"> </span>because<span class="_ _3"> </span><span class="ff9a ls6">p</span></div><div class="t m0 x18 h25 y2d78 ff9b fs10 fc2 sc0 ls6 ws2"></div><div class="t m0 x54 h20 y2d79 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff9a">u<span class="_ _5"></span></span>)<span class="_ _c"> </span><span class="ff9b">=<span class="_ _b"> </span><span class="ff9a">p<span class="_ _5"></span></span></span>(<span class="ff9a">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>h<span class="_ _2a"></span></span>)<span class="_ _6"> </span><span class="ff5c lse">is<span class="_ _d"> </span>a<span class="_ _6"> </span>polynomial<span class="_ _6"> </span>of<span class="_ _d"> </span>equal<span class="_ _6"> </span>degree<span class="_ _d"> </span>as</span></div><div class="t m0 x118 h20 y2d7a ff9a fs4 fc2 sc0 ls6 ws2">p<span class="_ _5"></span><span class="ff56">(</span>u<span class="_ _5"></span><span class="ff56">)<span class="ff5c lsc">.<span class="_ _4"> </span>For<span class="_ _6"> </span>example,<span class="_ _6"> </span>if<span class="_ _b"> </span></span></span>p<span class="_ _5"></span><span class="ff56">(</span>u<span class="_ _2a"></span><span class="ff56">)<span class="_ _4"> </span><span class="ff9b">=<span class="_ _c"> </span></span></span>t</div><div class="t m0 x15f h1b y2d7b ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x19e h2a y2d7c ff9a fs4 fc2 sc0 ls6 ws2">u</div><div class="t m0 xdd h1b y2d7d ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x155 h20 y2d7c ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _d"> </span><span class="ff9a">t</span></div><div class="t m0 x63 h1b y2d7b ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 xeb h20 y2d7c ff9a fs4 fc2 sc0 ls6 ws2">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>t</div><div class="t m0 x1bd h1b y2d7b ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x1d7 h15 y2d7c ff5c fs4 fc2 sc0 ls14 ws2">,<span class="_ _6"> </span>then</div><div class="t m0 x12f h2a y2d7e ff9a fs4 fc2 sc0 ls6 ws2">p</div><div class="t m0 x194 h25 y2d7f ff9b fs10 fc2 sc0 ls6 ws2"></div><div class="t m0 x200 h20 y2d80 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff9a">u<span class="_ _5"></span></span>)<span class="_ _c"> </span><span class="ff9b">=<span class="_ _4"> </span><span class="ff9a">t</span></span></div><div class="t m0 xcf h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x3f h20 y2d80 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff9a">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>h<span class="_ _5"></span></span>)</div><div class="t m0 x71 h1b y2d7f ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x92 h20 y2d80 ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _d"> </span><span class="ff9a">t</span></div><div class="t m0 xe1 h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x1d9 h20 y2d80 ff56 fs4 fc2 sc0 ls6 ws2">(<span class="ff9a">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>h<span class="_ _5"></span></span>)<span class="_ _6"> </span><span class="ff9b">+<span class="_ _6"> </span><span class="ff9a">t</span></span></div><div class="t m0 xde h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x179 h20 y2d80 ff9b fs4 fc2 sc0 ls6 ws2">=<span class="_ _4"> </span><span class="ff9a">t</span></div><div class="t m0 x129 h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 xbe h2a y2d80 ff9a fs4 fc2 sc0 ls6 ws2">u</div><div class="t m0 x1b3 h1b y2d7f ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x79 h20 y2d80 ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _d"> </span><span class="ff56">(<span class="ff5c">2<span class="_ _5"></span><span class="ff9a ls19a">ht</span></span></span></div><div class="t m0 xa6 h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x186 h20 y2d80 ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _d"> </span><span class="ff9a">t</span></div><div class="t m0 xaf h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 xb0 h20 y2d80 ff56 fs4 fc2 sc0 ls6 ws2">)<span class="ff9a">u<span class="_ _4"> </span><span class="ff9b">+<span class="_ _6"> </span></span>t</span></div><div class="t m0 xdf h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x10c h2a y2d80 ff9a fs4 fc2 sc0 ls6 ws2">h</div><div class="t m0 x56 h1b y2d7f ff5c fs10 fc2 sc0 ls6 ws2">2</div><div class="t m0 x142 h20 y2d80 ff9b fs4 fc2 sc0 ls6 ws2">+<span class="_ _d"> </span><span class="ff9a">t</span></div><div class="t m0 x114 h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">1</div><div class="t m0 x15d h20 y2d80 ff9a fs4 fc2 sc0 ls6 ws2">h<span class="_"> </span><span class="ff9b">+<span class="_ _6"> </span></span>t</div><div class="t m0 x1a0 h1b y2d81 ff5c fs10 fc2 sc0 ls6 ws2">0</div><div class="t m0 x17d h2b y2d80 ff56 fs4 fc2 sc0 ls6 ws2">.</div><div class="t m0 xac h35 y2d82 ff99 fsf fc2 sc0 ls18 ws2">15.2.2<span class="_ _2f"> </span>Dynamic<span class="_ _d"> </span>T<span class="_ _16"></span>rees</div><div class="t m0 xac h15 y2d83 ff5c fs4 fc2 sc0 lsc ws2">An<span class="_ _6"> </span>ordinary<span class="_ _4"> </span>segment<span class="_ _6"> </span>tree<span class="_ _4"> </span>is<span class="_ _4"> </span>static,<span class="_ _4"> </span>which<span class="_ _6"> </span>means<span class="_ _4"> </span>that<span class="_ _4"> </span>each<span class="_ _4"> </span>node<span class="_ _6"> </span>has<span class="_ _4"> </span>a<span class="_ _4"> </span>ﬁxed<span class="_ _6"> </span>position</div><div class="t m0 xac h15 y2d84 ff5c fs4 fc2 sc0 lsc ws2">in<span class="_ _4"> </span>the<span class="_ _4"> </span>segment<span class="_ _6"> </span>tree<span class="_ _4"> </span>array<span class="_ _4"> </span>and<span class="_ _c"> </span>the<span class="_ _6"> </span>structure<span class="_ _4"> </span>requires<span class="_ _4"> </span>a<span class="_ _4"> </span>ﬁxed<span class="_ _4"> </span>amount<span class="_ _4"> </span>of<span class="_ _4"> </span>memory<span class="_ _16"></span>.<span class="_ _c"> </span>In<span class="_ _6"> </span>a</div><div class="t m0 xac h15 y2d85 ff9a fs4 fc2 sc0 lsc ws2">dynamic<span class="_ _d"> </span>segment<span class="_ _d"> </span>tr<span class="_ _0"></span>ee<span class="ff5c">,<span class="_ _d"> </span>memory<span class="_ _6"> </span>is<span class="_ _6"> </span>allocated<span class="_ _d"> </span>only<span class="_ _6"> </span>for<span class="_ _d"> </span>nodes<span class="_ _6"> </span>that<span class="_ _6"> </span>are<span class="_ _d"> </span>actually<span class="_ _6"> </span>accessed</span></div><div class="t m0 xac h15 y2d86 ff5c fs4 fc2 sc0 lsc ws2">during<span class="_ _6"> </span>the<span class="_ _4"> </span>algorithm,<span class="_ _6"> </span>which<span class="_ _4"> </span>can<span class="_ _4"> </span>sav<span class="_ _0"></span>e<span class="_ _6"> </span>a<span class="_ _4"> </span>large<span class="_ _6"> </span>amount<span class="_ _6"> </span>of<span class="_ _4"> </span>memory<span class="_ _16"></span>.</div><div class="t m0 x35 h15 y2d87 ff5c fs4 fc2 sc0 lsc ws2">The<span class="_ _6"> </span>nodes<span class="_ _4"> </span>of<span class="_ _6"> </span>a<span class="_ _4"> </span>dynamic<span class="_ _4"> </span>tree<span class="_ _6"> </span>can<span class="_ _4"> </span>be<span class="_ _6"> </span>represented<span class="_ _4"> </span>as<span class="_ _4"> </span>structs:</div><div class="t m0 x3b h21 y477 ff1e fsc fc2 sc0 ls1f ws2">struct<span class="_ _14"> </span><span class="ff5a">node<span class="_ _f"> </span>{</span></div><div class="t m0 x3c h21 y2d88 ff1e fsc fc2 sc0 ls1f ws2">int<span class="_ _14"> </span><span class="ff5a ls12">value;</span></div><div class="t m0 x3c h21 y2d89 ff1e fsc fc2 sc0 ls1f ws2">int<span class="_ _14"> </span><span class="ff5a ls10">x,<span class="_ _f"> </span>y;</span></div><div class="t m0 x3c h21 y2d8a ff5a fsc fc2 sc0 ls20 ws2">node<span class="_ _14"> </span>*left,<span class="_ _f"> </span>*right;</div><div class="t m0 x3c h21 y2d8b ff5a fsc fc2 sc0 ls10 ws2">node(<span class="ff1e ls1f">int<span class="_ _14"> </span><span class="ff5a">v,<span class="_ _f"> </span></span>int<span class="_ _14"> </span></span><span class="ls27">x,<span class="_ _f"> </span><span class="ff1e ls1f">int<span class="_ _14"> </span></span><span class="ls20">y)<span class="_ _14"> </span>:<span class="_ _f"> </span>value(v),<span class="_ _14"> </span>x(x),<span class="_ _f"> </span>y(y)<span class="_ _14"> </span>{}</span></span></div><div class="t m0 x3b h21 y2d8c ff5a fsc fc2 sc0 ls1f ws2">};</div><div class="t m0 x35 h23 y2d8d ff5c fs4 fc2 sc0 ls6 ws2">Here<span class="_ _d"> </span><span class="ff5a lsc">value<span class="_ _15"> </span><span class="ff5c">is<span class="_ _d"> </span>the<span class="_ _15"> </span>value<span class="_ _15"> </span>of<span class="_ _d"> </span>the<span class="_ _15"> </span>node,<span class="_ _d"> </span></span></span><span class="ff9b">[<span class="ff5a">x<span class="ff56">,<span class="_ _2d"> </span></span>y</span>]<span class="_ _d"> </span></span><span class="lsc">is<span class="_ _d"> </span>the<span class="_ _15"> </span>corresponding<span class="_ _d"> </span>range,<span class="_ _15"> </span>and<span class="_ _6"> </span><span class="ff5a">left</span></span></div><div class="t m0 xac h23 y2d8e ff5c fs4 fc2 sc0 ls14 ws2">and<span class="_ _4"> </span><span class="ff5a lsc">right<span class="_ _4"> </span><span class="ff5c">point<span class="_ _6"> </span>to<span class="_ _4"> </span>the<span class="_ _6"> </span>left<span class="_ _4"> </span>and<span class="_ _6"> </span>right<span class="_ _4"> </span>subtree.<span class="_ _4"> </span>Nodes<span class="_ _6"> </span>can<span class="_ _4"> </span>be<span class="_ _6"> </span>created<span class="_ _4"> </span>as<span class="_ _6"> </span>follows:</span></span></div></div><div class="pi" data-data='{"ctm":[2.275981,0.000000,0.000000,2.275981,0.000000,0.000000]}'></div></div>

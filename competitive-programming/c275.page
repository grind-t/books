<div id="pf113" class="pf w2 h6" data-page-no="113"><div class="pc pc113 w2 h6"><img class="bi x0 y0 w1 h1" alt="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA3AAAAU1CAIAAADdzbFlAAAACXBIWXMAABYlAAAWJQFJUiTwAAAVvElEQVR42u3Zv03rUBjG4ftd2V2qO4GbDBCGYIgUmYMRmIMoSzAEWSAiLJHO0kdzC2gs8J/AyXme2rKiNyj+4ROZ+QcAAMb6awIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQBAgRoTTNQ9PBsBAEr09nhvhFl4QwkAwCSRmVYAAGA0bygBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAYzQmAKhZRBiBmmWmEQQlAL/xgRoRL8fjvPe822yKuOdyH3Whb2r225ZyT/9QzciRNwAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAD4mshMKwBUa7/f73Y7O1Cnw+Gw3W7tICgBAPhhjrwBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAwNc0JgCoWd/3bdvagTplphFmEaYEqPoxEIs8CJa4bUS8HI/z3vNus5n9ngvdtqyPusS3X8ofap0ceQMAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAwBVEZloBoFqn02m9XtuBOp3P567r7CAoAQD4YY68AQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAgKtpTEDpLpfLarUauCAzrQRw2yJi+ALPgmX3ty8AAFM48gYAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAACM0ZgA4KOIGL4gM60E8OmX0y8jAABTOPIGAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAAjNGYAGbU933btsPXZKahALgl4dkGAMAUjrwBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEFpAgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAKA0jQmgIH3ft207fE1mGgqAawrPHgAApnDkDQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAPx6jQkm6h6ejQAAJXp7vDfCLLyhBABgkshMKwAAMJo3lAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoDQBAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQAAghIAAEEJAICgBABAUAIAgKAEAEBQAgAgKAEAEJQAACAoAQAQlAAACEoAAAQlAAAISgAABCUAAIISAABBCQCAoAQAAEEJAICgBABAUAIAICgBAEBQAgAgKAEAEJQAAAhKAAAQlAAACEoAAAQlAACCEgAABCUAAIISAABBCQCAoAQAQFACAICgBABAUAIAICgBABCUAAAgKAEAEJQAAAhKAAAEJQAACEoAAAQlAACCEgAAQQkAAIISAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAAEEJAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAIISAAAEJQAAghIAAEEJAICgBAAAQQkAgKAEAEBQAgAgKAEAQFACACAoAQAQlAAACEoAABCUAAAISgAABCUAAIISAABBaQIAAAQlAACCEgAAQQkAgKAEAABBCQCAoAQAQFACACAoAQBAUAIAICgBABCUAAAISgAAEJQAAAhKAAAEJQAAghIAAAQlAACCEgAAQQkAgKAEAEBQAgCAoAQAQFACACAoAQAQlAAAICgBABCUAAAISgAABCUAAAhKAAAEJQAAghIAgBsLyvjv6fVfRESYBACA73gHHj6b7BB1YywAAAAASUVORK5CYII="/><div class="t m0 xac h19 y18c ff9c fsc fc2 sc0 ls20 ws2">15.1<span class="_ _14"> </span>Square<span class="_ _15"> </span>Root<span class="_ _2d"> </span>T<span class="_ _0"></span>echniques<span class="_ _d1"> </span>269</div><div class="t m0 xac h39 y387 ff99 fsc fc4 sc0 ls6 ws2">Fig<span class="_ _0"></span>.<span class="_ _36"> </span>15.8<span class="_ _f"> </span><span class="ff5c fc2 ls10">Mo<span class="_ _0"></span>ving<span class="_ _d"> </span>between</span></div><div class="t m0 xac h18 y388 ff5c fsc fc2 sc0 ls10 ws2">two<span class="_ _15"> </span>ranges<span class="_ _d"> </span>in<span class="_ _15"> </span>Mo’<span class="_ _0"></span>s<span class="_ _d"> </span>algorithm</div><div class="t m0 x66 h43 y2cbf ff9d fs13 fc2 sc0 ls54 ws2">42</div><div class="t m0 xfe h43 y2cc0 ff9d fs13 fc2 sc0 ls6 ws2">5</div><div class="t m0 x67 h43 y2cbf ff9d fs13 fc2 sc0 ls54 ws2">424</div><div class="t m0 x6a h43 y2cc0 ff9d fs13 fc2 sc0 ls59 ws2">33</div><div class="t m0 x6b h43 y2cbf ff9d fs13 fc2 sc0 ls6 ws2">4</div><div class="t m0 x66 h43 y2cc1 ff9d fs13 fc2 sc0 ls54 ws2">42</div><div class="t m0 xfe h43 y2cc2 ff9d fs13 fc2 sc0 ls6 ws2">5</div><div class="t m0 x67 h43 y2cc1 ff9d fs13 fc2 sc0 ls54 ws2">424</div><div class="t m0 x6a h43 y2cc2 ff9d fs13 fc2 sc0 ls59 ws2">33</div><div class="t m0 x6b h43 y2cc1 ff9d fs13 fc2 sc0 ls6 ws2">4</div><div class="t m0 x35 h15 y2cc3 ff5c fs4 fc2 sc0 lsd ws2">Thus,<span class="_ _15"> </span>all<span class="_ _15"> </span>queries<span class="_ _15"> </span>whose<span class="_ _15"> </span>left<span class="_ _15"> </span>endpoints<span class="_ _15"> </span>are<span class="_ _15"> </span>in<span class="_ _15"> </span>a<span class="_ _15"> </span>certain<span class="_ _15"> </span>block<span class="_ _15"> </span>are<span class="_ _15"> </span>processed<span class="_ _15"> </span>one<span class="_ _d"> </span>after</div><div class="t m0 xac h15 y2cc4 ff5c fs4 fc2 sc0 lsc ws2">another<span class="_ _15"> </span>sorted<span class="_ _d"> </span>according<span class="_ _15"> </span>to<span class="_ _d"> </span>their<span class="_ _15"> </span>right<span class="_ _d"> </span>endpoints.<span class="_ _15"> </span>Using<span class="_ _d"> </span>this<span class="_ _15"> </span>order,<span class="_ _15"> </span>the<span class="_ _15"> </span>algorithm<span class="_ _d"> </span>only</div><div class="t m0 xac h15 y2cc5 ff5c fs4 fc2 sc0 lsd ws2">performs<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _36"></span><span class="ff56">(</span>n</span></div><div class="t m0 xa h20 y2cc6 ff9b fs4 fc2 sc0 ls6 ws2">√</div><div class="t m0 x131 h15 y2cc7 ff9a fs4 fc2 sc0 ls6 ws2">n<span class="_ _5"></span><span class="ff56">)<span class="_ _4"> </span><span class="ff5c lsc">operations,<span class="_ _4"> </span>because<span class="_ _4"> </span>the<span class="_ _4"> </span>left<span class="_ _4"> </span>endpoint<span class="_ _4"> </span>mov<span class="_ _0"></span>es<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _36"></span><span class="ff56">(</span>n<span class="_ _5"></span><span class="ff56">)<span class="_ _4"> </span></span></span><span class="lsd">times<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _36"></span><span class="ff56">(</span></span></span></span></span></div><div class="t m0 x1c8 h20 y2cc8 ff9b fs4 fc2 sc0 ls6 ws2">√</div><div class="t m0 x6b h2a y2cc7 ff9a fs4 fc2 sc0 ls6 ws2">n<span class="_ _5"></span><span class="ff56">)</span></div><div class="t m0 xac h15 y2cc9 ff5c fs4 fc2 sc0 lsc ws2">steps,<span class="_ _6"> </span>and<span class="_ _6"> </span>the<span class="_ _4"> </span>right<span class="_ _6"> </span>endpoint<span class="_ _4"> </span>mov<span class="_ _0"></span>es<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _2a"></span><span class="ff56">(</span></span></div><div class="t m0 x14b h20 y2cca ff9b fs4 fc2 sc0 ls6 ws2">√</div><div class="t m0 xc2 h15 y2ccb ff9a fs4 fc2 sc0 ls6 ws2">n<span class="_ _5"></span><span class="ff56">)<span class="_ _6"> </span><span class="ff5c lsd">times<span class="_ _c"> </span></span></span>O<span class="_ _36"></span><span class="ff56">(</span>n<span class="_ _5"></span><span class="ff56">)<span class="_ _4"> </span><span class="ff5c lsd">steps.<span class="_ _6"> </span>Thus,<span class="_ _6"> </span>both<span class="_ _4"> </span>endpoints</span></span></div><div class="t m0 xac h15 y2ccc ff5c fs4 fc2 sc0 lse ws2">mov<span class="_ _0"></span>e<span class="_ _6"> </span>a<span class="_ _4"> </span>total<span class="_ _4"> </span>of<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _2a"></span><span class="ff56">(</span>n</span></div><div class="t m0 x146 h20 y2ccd ff9b fs4 fc2 sc0 ls6 ws2">√</div><div class="t m0 x92 h15 y2cce ff9a fs4 fc2 sc0 ls6 ws2">n<span class="_ _5"></span><span class="ff56">)<span class="_ _4"> </span><span class="ff5c lsd">steps<span class="_ _6"> </span>during<span class="_ _4"> </span>the<span class="_ _6"> </span>algorithm.</span></span></div><div class="t m0 xac h8 y2ccf ff21 fs4 fc2 sc0 lsc ws2">Example<span class="_ _4"> </span><span class="ff5c lsd">Consider<span class="_ _4"> </span>a<span class="_ _4"> </span>problem<span class="_ _4"> </span>where<span class="_ _4"> </span>we<span class="_ _4"> </span>are<span class="_ _4"> </span>given<span class="_ _6"> </span>a<span class="_ _4"> </span>set<span class="_ _4"> </span>of<span class="_ _4"> </span>array<span class="_ _4"> </span>ranges,<span class="_ _4"> </span>and<span class="_ _4"> </span>we<span class="_ _4"> </span>are</span></div><div class="t m0 xac h15 y2cd0 ff5c fs4 fc2 sc0 lse ws2">asked<span class="_ _c"> </span>to<span class="_ _c"> </span>calculate<span class="_ _4"> </span>the<span class="_ _c"> </span>number<span class="_ _c"> </span>of<span class="_ _c"> </span><span class="ff9a lsd">distinct<span class="_ _b"> </span></span><span class="lsc">v<span class="_ _0"></span>alues<span class="_ _c"> </span>in<span class="_ _c"> </span>each<span class="_ _c"> </span>range.<span class="_ _c"> </span>In<span class="_ _c"> </span>Mo’<span class="_ _16"></span>s<span class="_ _c"> </span>algorithm,</span></div><div class="t m0 xac h15 y2cd1 ff5c fs4 fc2 sc0 lsc ws2">the<span class="_ _4"> </span>queries<span class="_ _4"> </span>are<span class="_ _c"> </span>alw<span class="_ _0"></span>ays<span class="_ _4"> </span>sorted<span class="_ _c"> </span>in<span class="_ _6"> </span>the<span class="_ _c"> </span>same<span class="_ _4"> </span>way<span class="_ _16"></span>,<span class="_ _4"> </span>but<span class="_ _4"> </span>the<span class="_ _4"> </span>way<span class="_ _4"> </span>the<span class="_ _c"> </span>answer<span class="_ _4"> </span>to<span class="_ _4"> </span>the<span class="_ _4"> </span>query</div><div class="t m0 xac h15 y2cd2 ff5c fs4 fc2 sc0 lsc ws2">is<span class="_ _6"> </span>maintained<span class="_ _4"> </span>depends<span class="_ _6"> </span>on<span class="_ _4"> </span>the<span class="_ _4"> </span>problem.</div><div class="t m0 x35 h23 y2cd3 ff5c fs4 fc2 sc0 lsd ws2">T<span class="_ _16"></span>o<span class="_ _c"> </span>solv<span class="_ _0"></span>e<span class="_ _c"> </span>the<span class="_ _c"> </span>problem,<span class="_ _c"> </span>we<span class="_ _c"> </span>maintain<span class="_ _c"> </span>an<span class="_ _4"> </span>array<span class="_ _c"> </span><span class="ff5a lsc">count<span class="_ _c"> </span><span class="ff5c">where<span class="_ _c"> </span></span><span class="lsd">count<span class="ff9b ls6">[<span class="_ _5"></span><span class="ff9a">x<span class="_ _36"></span></span>]<span class="_ _c"> </span></span></span><span class="ff5c">indicates</span></span></div><div class="t m0 xac h15 y2cd4 ff5c fs4 fc2 sc0 lse ws2">the<span class="_ _4"> </span>number<span class="_ _c"> </span>of<span class="_ _4"> </span>times<span class="_ _c"> </span>an<span class="_ _4"> </span>element<span class="_ _c"> </span><span class="ff9a ls6">x<span class="_ _b"> </span></span><span class="lsc">occurs<span class="_ _c"> </span>in<span class="_ _4"> </span>the<span class="_ _4"> </span>active<span class="_ _4"> </span>range.<span class="_ _4"> </span>When<span class="_ _c"> </span>we<span class="_ _4"> </span>move<span class="_ _4"> </span>from</span></div><div class="t m0 xac h15 y2cd5 ff5c fs4 fc2 sc0 lse ws2">one<span class="_ _6"> </span>query<span class="_ _6"> </span>to<span class="_ _d"> </span>another<span class="_ _6"> </span>query<span class="_ _0"></span>,<span class="_ _d"> </span>the<span class="_ _6"> </span>active<span class="_ _d"> </span>range<span class="_ _6"> </span>changes.<span class="_ _6"> </span>For<span class="_ _d"> </span>example,<span class="_ _6"> </span>consider<span class="_ _6"> </span>the<span class="_ _6"> </span>two</div><div class="t m0 xac h15 y2cd6 ff5c fs4 fc2 sc0 lsc ws2">ranges<span class="_ _15"> </span>in<span class="_ _15"> </span>Fig.<span class="_ _2d"> </span><span class="fc3">15.8</span>.<span class="_ _15"> </span>When<span class="_ _15"> </span>we<span class="_ _d"> </span>mov<span class="_ _0"></span>e<span class="_ _15"> </span>from<span class="_ _d"> </span>the<span class="_ _15"> </span>ﬁrst<span class="_ _15"> </span>range<span class="_ _d"> </span>to<span class="_ _15"> </span>the<span class="_ _15"> </span>second<span class="_ _d"> </span>range,<span class="_ _15"> </span>there<span class="_ _15"> </span>will</div><div class="t m0 xac h15 y2cd7 ff5c fs4 fc2 sc0 lsc ws2">be<span class="_ _6"> </span>three<span class="_ _4"> </span>steps:<span class="_ _4"> </span>The<span class="_ _4"> </span>left<span class="_ _4"> </span>endpoint<span class="_ _6"> </span>moves<span class="_ _6"> </span>one<span class="_ _4"> </span>step<span class="_ _4"> </span>to<span class="_ _4"> </span>the<span class="_ _6"> </span>right,<span class="_ _4"> </span>and<span class="_ _4"> </span>the<span class="_ _4"> </span>right<span class="_ _4"> </span>endpoint</div><div class="t m0 xac h15 y2cd8 ff5c fs4 fc2 sc0 lsd ws2">mov<span class="_ _0"></span>es<span class="_ _6"> </span>two<span class="_ _4"> </span>steps<span class="_ _6"> </span>to<span class="_ _4"> </span>the<span class="_ _6"> </span>right.</div><div class="t m0 x35 h23 y2cd9 ff5c fs4 fc2 sc0 lsd ws2">After<span class="_ _4"> </span>each<span class="_ _c"> </span>step,<span class="_ _4"> </span>the<span class="_ _c"> </span>array<span class="_ _4"> </span><span class="ff5a lsc">count<span class="_ _c"> </span></span><span class="lse">needs<span class="_ _c"> </span>to<span class="_ _4"> </span>be<span class="_ _4"> </span>updated.<span class="_ _c"> </span>After<span class="_ _c"> </span>adding<span class="_ _4"> </span>an<span class="_ _c"> </span>element</span></div><div class="t m0 x4 h23 y2cda ff9a fs4 fc2 sc0 ls6 ws2">x<span class="_ _36"></span><span class="ff5c lsc">,<span class="_ _3"> </span>we<span class="_ _b"> </span>increase<span class="_ _b"> </span>the<span class="_ _b"> </span>v<span class="_ _0"></span>alue<span class="_ _b"> </span>of<span class="_ _3"> </span><span class="ff5a">count<span class="ff9b ls6">[<span class="_ _5"></span><span class="ff9a">x<span class="_ _36"></span></span>]<span class="_ _b"> </span></span></span><span class="lse">by<span class="_ _3"> </span>1,<span class="_ _b"> </span>and<span class="_ _b"> </span>if<span class="_ _b"> </span></span><span class="ff5a">count<span class="ff9b ls6">[<span class="_ _5"></span><span class="ff9a">x<span class="_ _36"></span></span><span class="ls7f">]=</span><span class="ff5c">1<span class="_ _3"> </span>after<span class="_ _b"> </span>this,<span class="_ _b"> </span>we</span></span></span></span></div><div class="t m0 xac h15 y2cdb ff5c fs4 fc2 sc0 lsd ws2">also<span class="_ _3"> </span>increase<span class="_ _b"> </span>the<span class="_ _b"> </span>answer<span class="_ _3"> </span>to<span class="_ _b"> </span>the<span class="_ _b"> </span>query<span class="_ _3"> </span>by<span class="_ _b"> </span>1.<span class="_ _b"> </span>Similarly<span class="_ _16"></span>,<span class="_ _3"> </span>after<span class="_ _b"> </span>removing<span class="_ _3"> </span>an<span class="_ _b"> </span>element</div><div class="t m0 x4 h23 y2cdc ff9a fs4 fc2 sc0 ls6 ws2">x<span class="_ _36"></span><span class="ff5c lsc">,<span class="_ _3"> </span>we<span class="_ _3"> </span>decrease<span class="_ _b"> </span>the<span class="_ _3"> </span>value<span class="_ _c"> </span>of<span class="_ _b"> </span><span class="ff5a">count</span></span><span class="ff9b">[<span class="_ _5"></span></span>x<span class="_ _36"></span><span class="ff9b">]<span class="_"> </span><span class="ff5c lse">by<span class="_ _3"> </span>1,<span class="_ _b"> </span>and<span class="_ _3"> </span>if<span class="_ _3"> </span><span class="ff5a lsc">count</span></span>[<span class="_ _5"></span></span>x<span class="_ _36"></span><span class="ff9b lse7">]=</span><span class="ff5c">0<span class="_ _b"> </span>after<span class="_ _3"> </span>this,<span class="_ _3"> </span>we</span></div><div class="t m0 xac h15 y2cdd ff5c fs4 fc2 sc0 lsc ws2">also<span class="_ _4"> </span>decrease<span class="_ _4"> </span>the<span class="_ _6"> </span>answer<span class="_ _4"> </span>to<span class="_ _4"> </span>the<span class="_ _4"> </span>query<span class="_ _4"> </span>by<span class="_ _4"> </span>1.<span class="_ _4"> </span>Since<span class="_ _4"> </span>each<span class="_ _4"> </span>step<span class="_ _4"> </span>requires<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _36"></span><span class="ff56">(<span class="ff5c">1</span>)<span class="_ _4"> </span></span></span><span class="lsd">time,<span class="_ _4"> </span>the</span></div><div class="t m0 xac h15 y2cde ff5c fs4 fc2 sc0 lsd ws2">algorithm<span class="_ _6"> </span>works<span class="_ _4"> </span>in<span class="_ _c"> </span><span class="ff9a ls6">O<span class="_ _2a"></span><span class="ff56">(</span>n</span></div><div class="t m0 x2d h20 y2cdf ff9b fs4 fc2 sc0 ls6 ws2">√</div><div class="t m0 xe2 h15 y2ce0 ff9a fs4 fc2 sc0 ls6 ws2">n<span class="_ _5"></span><span class="ff56">)<span class="_ _4"> </span><span class="ff5c lsd">time.</span></span></div><div class="t m0 xac h34 y2ce1 ff99 fse fc2 sc0 ls61 ws2">15.2<span class="_ _2f"> </span>Segment<span class="_ _d"> </span>T<span class="_ _16"></span>rees<span class="_ _6"> </span>Revisited</div><div class="t m0 xac h15 y2ce2 ff5c fs4 fc2 sc0 lsd ws2">A<span class="_ _6"> </span>segment<span class="_ _4"> </span>tree<span class="_ _6"> </span>is<span class="_ _4"> </span>a<span class="_ _4"> </span>versatile<span class="_ _6"> </span>data<span class="_ _4"> </span>structure<span class="_ _4"> </span>that<span class="_ _6"> </span>can<span class="_ _4"> </span>be<span class="_ _4"> </span>used<span class="_ _4"> </span>to<span class="_ _6"> </span>solve<span class="_ _6"> </span>a<span class="_ _4"> </span>large<span class="_ _6"> </span>number</div><div class="t m0 xac h15 y2ce3 ff5c fs4 fc2 sc0 lsd ws2">of<span class="_ _4"> </span>problems.<span class="_ _c"> </span>Ho<span class="_ _0"></span>wev<span class="_ _0"></span>er<span class="_ _0"></span>,<span class="_ _4"> </span>so<span class="_ _c"> </span>far<span class="_ _4"> </span>we<span class="_ _c"> </span>ha<span class="_ _0"></span>ve<span class="_ _4"> </span>only<span class="_ _c"> </span>seen<span class="_ _4"> </span>a<span class="_ _4"> </span>small<span class="_ _c"> </span>part<span class="_ _4"> </span>of<span class="_ _c"> </span>the<span class="_ _4"> </span>possibilities<span class="_ _c"> </span>of</div><div class="t m0 xac h15 y2ce4 ff5c fs4 fc2 sc0 lsd ws2">segment<span class="_ _6"> </span>trees.<span class="_ _4"> </span>Now<span class="_ _6"> </span>is<span class="_ _4"> </span>the<span class="_ _4"> </span>time<span class="_ _4"> </span>to<span class="_ _6"> </span>discuss<span class="_ _4"> </span>some<span class="_ _4"> </span>more<span class="_ _4"> </span>advanced<span class="_ _6"> </span>variants<span class="_ _6"> </span>of<span class="_ _4"> </span>segment</div><div class="t m0 xac h15 y2ce5 ff5c fs4 fc2 sc0 lsc ws2">trees<span class="_ _6"> </span>that<span class="_ _4"> </span>allow<span class="_ _6"> </span>us<span class="_ _6"> </span>to<span class="_ _4"> </span>solve<span class="_ _6"> </span>more<span class="_ _6"> </span>advanced<span class="_ _6"> </span>problems.</div><div class="t m0 x35 h15 y2ce6 ff5c fs4 fc2 sc0 lsc ws2">Until<span class="_ _15"> </span>now<span class="_ _16"></span>,<span class="_ _15"> </span>we<span class="_ _d"> </span>hav<span class="_ _0"></span>e<span class="_ _d"> </span>implemented<span class="_ _15"> </span>the<span class="_ _d"> </span>operations<span class="_ _15"> </span>of<span class="_ _d"> </span>a<span class="_ _d"> </span>segment<span class="_ _15"> </span>tree<span class="_ _15"> </span>by<span class="_ _d"> </span>walking<span class="_ _15"> </span><span class="ff9a lsd">fr<span class="_ _0"></span>om</span></div><div class="t m0 xac h15 y2ce7 ff9a fs4 fc2 sc0 lsc ws2">bottom<span class="_ _c"> </span>to<span class="_ _4"> </span>top<span class="_ _c"> </span><span class="ff5c">in<span class="_ _c"> </span>the<span class="_ _4"> </span>t<span class="_"> </span>ree.<span class="_ _c"> </span>For<span class="_ _c"> </span>e<span class="_ _0"></span>xample,<span class="_ _c"> </span>we<span class="_ _4"> </span>have<span class="_ _4"> </span>used<span class="_ _c"> </span>the<span class="_ _c"> </span>follo<span class="_ _0"></span>wing<span class="_ _c"> </span>function<span class="_ _4"> </span>(Sect.</span></div><div class="t m0 xac h20 y2ce8 ff5c fs4 fc3 sc0 lsd ws2">9.2.2<span class="fc2 lsc">)<span class="_ _6"> </span>to<span class="_ _4"> </span>calculate<span class="_ _6"> </span>the<span class="_ _4"> </span>sum<span class="_ _4"> </span>of<span class="_ _6"> </span>values<span class="_ _6"> </span>in<span class="_ _6"> </span>a<span class="_ _4"> </span>range<span class="_ _4"> </span><span class="ff9b ls6">[<span class="ff9a">a<span class="_ _5"></span><span class="ff56">,<span class="_ _15"> </span></span>b<span class="_ _5"></span></span>]<span class="ff5c">:</span></span></span></div><a class="l" href="#pf113" data-dest-detail='[275,"XYZ",89,609,null]'><div class="d m1" style="border-style:none;position:absolute;left:243.498092px;bottom:860.443680px;width:19.416000px;height:8.796000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://dx.doi.org/10.1007/978-3-030-39357-1_9"><div class="d m1" style="border-style:none;position:absolute;left:119.673351px;bottom:310.575800px;width:21.909000px;height:8.589000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.275981,0.000000,0.000000,2.275981,0.000000,0.000000]}'></div></div>
